
# 顔画像処理スクリプト

このPythonスクリプトは、入力フォルダ内の画像ファイルから顔（鼻）を検出し、トリミングとリサイズを行って出力フォルダに保存します。

## 機能

- 入力フォルダ内のすべての画像ファイル(.jpg、.jpeg、.png)を処理
- 顔検出と鼻の位置を基準にしたトリミング
- FFmpegを使用した高品質なリサイズ
- 処理結果を出力フォルダに保存

## 必要条件

- Python 3.x
- OpenCV (`cv2`)
- dlib
- FFmpeg（システムにインストールされていること）



## セットアップ

1. 必要なパッケージをインストールします：

```bash
pip install opencv-python dlib
```

2. 顔ランドマークモデルをダウンロードします。以下のコマンドを実行してください：

```bash
python download_model.py
```

これにより、`shape_predictor_68_face_landmarks.dat`ファイルがカレントディレクトリにダウンロードされます。

## 使用方法

1. 入力画像を`input`フォルダに配置します。
2. スクリプトを実行します：

```bash
python face_image_processor.py
```

3. 処理された画像が`output`フォルダに保存されます。

## カスタマイズ

`main`関数内の変数を編集することで、以下の設定を変更できます：

- `input_folder`: 入力画像のフォルダ（デフォルト: "input"）
- `output_folder`: 出力画像のフォルダ（デフォルト: "output"）
- `face_crop_percent`: 顔周辺のトリミング範囲（元の画像幅に対する割合、デフォルト: 70）
- `output_size`: 出力画像のサイズ（正方形、デフォルト: 480）

## 注意事項

- このスクリプトは顔が1つだけ検出される画像に最適化されています。
- 顔が検出できない場合、その画像はスキップされます。
- 処理結果は元のファイル名の前に"out_"を付けて保存されます。

